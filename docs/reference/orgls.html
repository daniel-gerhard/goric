<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fitting generalized least squares regression models with order restrictions — orgls • goric</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">goric</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/goric.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fitting generalized least squares regression models with order restrictions</h1>
    </div>

    
    <p>It determines the order-restricted maximum likelihood estimates 
and the corresponding log likelihood for the hypothesis of interest.
Additionally it gives the (unconstrained) maximum likelihood estimates and
the active contraints.</p>
    

    <pre class="usage"><span class='fu'>orgls</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='no'>constr</span>, <span class='no'>rhs</span>, <span class='no'>nec</span>, <span class='kw'>weights</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>correlation</span><span class='kw'>=</span><span class='kw'>NULL</span>,
      <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='orlmcontrol.html'>orlmcontrol</a></span>())
<span class='co'># S3 method for formula</span>
<span class='fu'>orgls</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='no'>constr</span>, <span class='no'>rhs</span>, <span class='no'>nec</span>, <span class='kw'>weights</span><span class='kw'>=</span><span class='kw'>NULL</span>,
<span class='kw'>correlation</span><span class='kw'>=</span><span class='kw'>NULL</span>,
      <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='orlmcontrol.html'>orlmcontrol</a></span>())</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>an object of class "formula" (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>an optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. If not found in data, the variables are taken from environment(formula), typically the environment from which orgls is called.</p></td>
    </tr>
    <tr>
      <th>constr</th>
      <td><p>matrix with constraints; with rows as constraint
    definition, columns should be in line with the parameters of the model</p></td>
    </tr>
    <tr>
      <th>rhs</th>
      <td><p>vector of right hand side elements; \(Constr \; \theta \geq
      rhs\); number should equal the number of rows of the constr matrix</p></td>
    </tr>
    <tr>
      <th>nec</th>
      <td><p>number of equality constraints; a numeric value treating
    the first nec constr rows as equality constraints, or a logical
    vector with <code>TRUE</code> for equality- and <code>FALSE</code> for
    inequality constraints.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>a <code>varClasses</code> object; more details are
    provided on the help pages in R package <code>nlme</code></p></td>
    </tr>
    <tr>
      <th>correlation</th>
      <td><p>a <code>corClasses</code> object; more details are
    provided on the help pages in R package <code>nlme</code></p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>a list of control arguments; see <code><a href='orlmcontrol.html'>orlmcontrol</a></code> for details.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The contraints in the hypothesis of interest are defined by 
\(Constr\), \(rhs\), and \(nec\).
The first \(nec\) constraints are the equality contraints:
\(Constr[1:nec, 1:tk] \theta = rhs[1:nec]\);
and the remaing ones are the inequality contraints:
\(Constr[nec+1:c_m, 1:tk] \theta \geq rhs[nec+1:c_m]\).</p>
<p>Two requirements should be met:</p><ol>
<li><p>The first \(nec\) constraints must be the equality contraints 
(i.e., \(Constr[1:nec, 1:tk] \theta = rhs[1:nec]\)) 
and the remaining ones the inequality contraints
(i.e., \(Constr[nec+1:c_m, 1:tk] \theta \geq rhs[nec+1:c_m]\)).</p></li>
<li><p>When \(rhs\) is not zero, \(Constr\) should be of full rank 
(after discarding redundant restrictions). 
More information can be obtained from Kuiper, Hoijtink, and Silvapulle (2011) and Kuiper, Hoijtink, and Silvapulle (unpublished).</p></li>
</ol>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an object of class orgls</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Kuiper R.M., Hoijtink H., Silvapulle M.J. (2011). An Akaike-type Information
Criterion for Model Selection Under Inequality Constraints. <em>Biometrika</em>, 
<b>98</b>, 495--501.</p>
<p>Kuiper R.M., Hoijtink H., Silvapulle M.J. (2012). Generalization of the Order-Restricted Information Criterion for Multivariate Normal Linear Models. <em>Journal of Statistical Planning and Inference</em>, <b>142</b>, 2454-2463. doi:10.1016/j.jspi.2012.03.007.</p>
<p>Kuiper R.M. and Hoijtink H. (submitted). A Fortran 90 Program for the Generalization of the Order-Restricted Information Criterion. Journal of Statictical Software.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code>solve.QP</code>, <code><a href='goric.html'>goric</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># generating example data</span>
<span class='fu'>library</span>(<span class='no'>mvtnorm</span>)
<span class='co'># group means</span>
<span class='no'>m</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>7</span>)
<span class='co'># compound symmetry structure of residuals</span>
<span class='co'># (10 individuals per group, rho=0.7) </span>
<span class='no'>cormat</span> <span class='kw'>&lt;-</span> <span class='fu'>kronecker</span>(<span class='fu'>diag</span>(<span class='fu'>length</span>(<span class='no'>m</span>)*<span class='fl'>10</span>), <span class='fu'>matrix</span>(<span class='fl'>0.7</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='fu'>length</span>(<span class='no'>m</span>), <span class='kw'>ncol</span><span class='kw'>=</span><span class='fu'>length</span>(<span class='no'>m</span>)))
<span class='fu'>diag</span>(<span class='no'>cormat</span>) <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='co'># different variances per group</span>
<span class='no'>sds</span> <span class='kw'>&lt;-</span> <span class='fu'>rep</span>(<span class='fu'>c</span>(<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>0.5</span>,<span class='fl'>1</span>), <span class='kw'>times</span><span class='kw'>=</span><span class='fl'>10</span>*<span class='fu'>length</span>(<span class='no'>m</span>))
<span class='no'>sigma</span> <span class='kw'>&lt;-</span> <span class='fu'>crossprod</span>(<span class='fu'>diag</span>(<span class='no'>sds</span>), <span class='fu'>crossprod</span>(<span class='no'>cormat</span>, <span class='fu'>diag</span>(<span class='no'>sds</span>)))
<span class='no'>response</span> <span class='kw'>&lt;-</span> <span class='fu'>as.vector</span>(<span class='fu'><a href='http://www.rdocumentation.org/packages/mvtnorm/topics/Mvnorm'>rmvnorm</a></span>(<span class='fl'>1</span>, <span class='fu'>rep</span>(<span class='no'>m</span>, <span class='kw'>times</span><span class='kw'>=</span><span class='fl'>10</span>*<span class='fu'>length</span>(<span class='no'>m</span>)), <span class='kw'>sigma</span><span class='kw'>=</span><span class='no'>sigma</span>))
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='no'>response</span>,
  <span class='kw'>grp</span><span class='kw'>=</span><span class='fu'>rep</span>(<span class='no'>LETTERS</span>[<span class='fl'>1</span>:<span class='fu'>length</span>(<span class='no'>m</span>)], <span class='kw'>times</span><span class='kw'>=</span><span class='fl'>10</span>*<span class='fu'>length</span>(<span class='no'>m</span>)),
  <span class='kw'>ID</span><span class='kw'>=</span><span class='fu'>as.factor</span>(<span class='fu'>rep</span>(<span class='fl'>1</span>:(<span class='fl'>10</span>*<span class='fu'>length</span>(<span class='no'>m</span>)), <span class='kw'>each</span><span class='kw'>=</span><span class='fu'>length</span>(<span class='no'>m</span>))))

<span class='co'>## set of gls models:</span>
<span class='co'># unconstrained model</span>
<span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='fu'>orgls</span>(<span class='no'>response</span> ~ <span class='no'>grp</span>-<span class='fl'>1</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>,
  <span class='kw'>constr</span><span class='kw'>=</span><span class='fu'>rbind</span>(<span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>)), <span class='kw'>rhs</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>nec</span><span class='kw'>=</span><span class='fl'>0</span>,
  <span class='kw'>weights</span><span class='kw'>=</span><span class='fu'>varIdent</span>(<span class='kw'>form</span><span class='kw'>=</span>~<span class='fl'>1</span><span class='kw'>|</span><span class='no'>grp</span>),
  <span class='kw'>correlation</span><span class='kw'>=</span><span class='fu'>corCompSymm</span>(<span class='kw'>form</span><span class='kw'>=</span>~<span class='fl'>1</span><span class='kw'>|</span><span class='no'>ID</span>))

<span class='co'># simple order</span>
<span class='no'>m2</span> <span class='kw'>&lt;-</span> <span class='fu'>orgls</span>(<span class='no'>response</span> ~ <span class='no'>grp</span>-<span class='fl'>1</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>,
  <span class='kw'>constr</span><span class='kw'>=</span><span class='fu'>rbind</span>(<span class='fu'>c</span>(-<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>),<span class='fu'>c</span>(<span class='fl'>0</span>,-<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>),<span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>0</span>,-<span class='fl'>1</span>,<span class='fl'>1</span>)), <span class='kw'>rhs</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>), <span class='kw'>nec</span><span class='kw'>=</span><span class='fl'>0</span>,
  <span class='kw'>weights</span><span class='kw'>=</span><span class='fu'>varIdent</span>(<span class='kw'>form</span><span class='kw'>=</span>~<span class='fl'>1</span><span class='kw'>|</span><span class='no'>grp</span>),
  <span class='kw'>correlation</span><span class='kw'>=</span><span class='fu'>corCompSymm</span>(<span class='kw'>form</span><span class='kw'>=</span>~<span class='fl'>1</span><span class='kw'>|</span><span class='no'>ID</span>))

<span class='co'># equality constraints</span>
<span class='no'>m3</span> <span class='kw'>&lt;-</span> <span class='fu'>orgls</span>(<span class='no'>response</span> ~ <span class='no'>grp</span>-<span class='fl'>1</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>,
  <span class='kw'>constr</span><span class='kw'>=</span><span class='fu'>rbind</span>(<span class='fu'>c</span>(-<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>),<span class='fu'>c</span>(<span class='fl'>0</span>,-<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>),<span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>0</span>,-<span class='fl'>1</span>,<span class='fl'>1</span>)), <span class='kw'>rhs</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>), <span class='kw'>nec</span><span class='kw'>=</span><span class='fl'>3</span>,
  <span class='kw'>weights</span><span class='kw'>=</span><span class='fu'>varIdent</span>(<span class='kw'>form</span><span class='kw'>=</span>~<span class='fl'>1</span><span class='kw'>|</span><span class='no'>grp</span>),
  <span class='kw'>correlation</span><span class='kw'>=</span><span class='fu'>corCompSymm</span>(<span class='kw'>form</span><span class='kw'>=</span>~<span class='fl'>1</span><span class='kw'>|</span><span class='no'>ID</span>))</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    Daniel Gerhard and Rebecca M. Kuiper
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Daniel Gerhard, Rebecca M. Kuiper.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
