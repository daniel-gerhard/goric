<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate GORIC — goric • goric</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">goric</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/goric.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate GORIC</h1>
    </div>

    
    <p>The goric function calculates the order-restricted log likelihood, the penalty of the generalised order restricted information criterion (GORIC), the GORIC values, differences to the minimum GORIC value, and the GORIC weights for a set of hypotheses, where the penalty is based on \(iter\) iterations.
The hypothesis with the lowest GORIC value is the preferred one. 
The GORIC weights reflect the support of each hypothesis in the set. To compare two hypotheses (and not one to the whole set), one should examine the ratio of the two corresponding GORIC weights.
To safequard for weak hypotheses (i.e., hypotheses not supported by the data), one should include a model with no constraints (the so-called unconstrained model).</p>
    

    <pre class="usage"><span class='fu'>goric</span>(<span class='no'>object</span>, <span class='no'>...</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>1e+05</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"GORIC"</span>, <span class='kw'>dispersion</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>mc.cores</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='co'># S3 method for orlm</span>
<span class='fu'>goric</span>(<span class='no'>object</span>, <span class='no'>...</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>1e+05</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"GORIC"</span>,
  <span class='kw'>mc.cores</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='co'># S3 method for orgls</span>
<span class='fu'>goric</span>(<span class='no'>object</span>, <span class='no'>...</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>1e+05</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"GORIC"</span>,
  <span class='kw'>mc.cores</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='co'># S3 method for list</span>
<span class='fu'>goric</span>(<span class='no'>object</span>, <span class='no'>...</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>1e+05</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"GORIC"</span>,
  <span class='kw'>dispersion</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>mc.cores</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='co'># S3 method for orglm</span>
<span class='fu'>goric</span>(<span class='no'>object</span>, <span class='no'>...</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>1e+05</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"GORIC"</span>,
  <span class='kw'>dispersion</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>mc.cores</span> <span class='kw'>=</span> <span class='fl'>1</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>an object of class orlm, orgls, orglm, or a list of these objects</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further objects of class orlm, orgls, or orglm</p></td>
    </tr>
    <tr>
      <th>iter</th>
      <td><p>number of iterations to calculate GORIC penalty terms</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>if <code>"GORIC"</code> (default), the penalty term for the generalized order restriction information criterion is computed; with <code>"GORICCa"</code> or <code>"GORICCb"</code> small sample corrections for the penalty term are applied</p></td>
    </tr>
    <tr>
      <th>dispersion</th>
      <td><p>dispersion parameter to scale GORIC analogously to QAIC in generalized linear models</p></td>
    </tr>
    <tr>
      <th>mc.cores</th>
      <td><p>number of cores using a socket cluster implemented in package <code>parallel</code></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a data.frame with the information criteria or a single penalty term</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <ul>
<li><p>Kuiper R.M., Hoijtink H., Silvapulle M.J. (2011). An Akaike-type Information Criterion for Model Selection Under Inequality Constraints. <em>Biometrika</em>, <b>98</b>, 495--501.</p></li>
<li><p>Kuiper R.M., Hoijtink H., Silvapulle M.J. (2012). Generalization of the Order-Restricted Information Criterion for Multivariate Normal Linear Models. <em>Journal of Statistical Planning and Inference</em>, <b>142</b>, 2454-2463. doi:10.1016/j.jspi.2012.03.007.</p></li>
<li><p>Kuiper R.M. and Hoijtink H. (submitted). A Fortran 90 Program for the Generalization of the Order-Restricted Information Criterion. Journal of Statictical Software.</p></li>
</ul>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='orlm.html'>orlm</a></code>, <code><a href='orgls.html'>orgls</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Example from Kuiper, R.M. and Hoijtink, H. (Unpublished).</span>
<span class='co'># A Fortran 90 program for the generalization of the </span>
<span class='co'># order restricted information criterion.</span>
<span class='co'># constraint definition</span>
<span class='no'>cmat</span> <span class='kw'>&lt;-</span> <span class='fu'>cbind</span>(<span class='fu'>diag</span>(<span class='fl'>3</span>), <span class='fl'>0</span>) + <span class='fu'>cbind</span>(<span class='fl'>0</span>, -<span class='fu'>diag</span>(<span class='fl'>3</span>))
<span class='no'>constr</span> <span class='kw'>&lt;-</span> <span class='fu'>kronecker</span>(<span class='fu'>diag</span>(<span class='fl'>3</span>), <span class='no'>cmat</span>)
<span class='no'>constr</span></div><div class='output co'>#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
#&gt;  [1,]    1   -1    0    0    0    0    0    0    0     0     0     0
#&gt;  [2,]    0    1   -1    0    0    0    0    0    0     0     0     0
#&gt;  [3,]    0    0    1   -1    0    0    0    0    0     0     0     0
#&gt;  [4,]    0    0    0    0    1   -1    0    0    0     0     0     0
#&gt;  [5,]    0    0    0    0    0    1   -1    0    0     0     0     0
#&gt;  [6,]    0    0    0    0    0    0    1   -1    0     0     0     0
#&gt;  [7,]    0    0    0    0    0    0    0    0    1    -1     0     0
#&gt;  [8,]    0    0    0    0    0    0    0    0    0     1    -1     0
#&gt;  [9,]    0    0    0    0    0    0    0    0    0     0     1    -1</div><div class='input'>
<span class='co'># no effect model</span>
<span class='no'>fm0</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='orlm.html'>orlm</a></span>(<span class='fu'>cbind</span>(<span class='no'>SDH</span>, <span class='no'>SGOT</span>, <span class='no'>SGPT</span>) ~ <span class='no'>dose</span>-<span class='fl'>1</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>vinylidene</span>,
            <span class='kw'>constr</span><span class='kw'>=</span><span class='no'>constr</span>, <span class='kw'>rhs</span><span class='kw'>=</span><span class='fu'>rep</span>(<span class='fl'>0</span>, <span class='fu'>nrow</span>(<span class='no'>constr</span>)), <span class='kw'>nec</span><span class='kw'>=</span><span class='fu'>nrow</span>(<span class='no'>constr</span>))
<span class='no'>fm0</span></div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; orlm.formula(formula = cbind(SDH, SGOT, SGPT) ~ dose - 1, data = vinylidene, 
#&gt;     constr = constr, rhs = rep(0, nrow(constr)), nec = nrow(constr))
#&gt; 
#&gt; Coefficients:
#&gt;         SDH     SGOT    SGPT  
#&gt; dosed1   24.12  105.38   59.70
#&gt; dosed2   24.12  105.38   59.70
#&gt; dosed3   24.12  105.38   59.70
#&gt; dosed4   24.12  105.37   59.70
#&gt; </div><div class='input'>
<span class='co'># order constrained model (increasing serum levels with increasing doses)</span>
<span class='no'>fm1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='orlm.html'>orlm</a></span>(<span class='fu'>cbind</span>(<span class='no'>SDH</span>, <span class='no'>SGOT</span>, <span class='no'>SGPT</span>) ~ <span class='no'>dose</span>-<span class='fl'>1</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>vinylidene</span>,
            <span class='kw'>constr</span><span class='kw'>=</span><span class='no'>constr</span>, <span class='kw'>rhs</span><span class='kw'>=</span><span class='fu'>rep</span>(<span class='fl'>0</span>, <span class='fu'>nrow</span>(<span class='no'>constr</span>)), <span class='kw'>nec</span><span class='kw'>=</span><span class='fl'>0</span>)
<span class='fu'>mmary</span>(<span class='no'>fm1</span>)</div><div class='output co'>#&gt; <span class='error'>Error in mmary(fm1): could not find function "mmary"</span></div><div class='input'>
<span class='co'># unconstrained model</span>
<span class='no'>fmunc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='orlm.html'>orlm</a></span>(<span class='fu'>cbind</span>(<span class='no'>SDH</span>, <span class='no'>SGOT</span>, <span class='no'>SGPT</span>) ~ <span class='no'>dose</span>-<span class='fl'>1</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>vinylidene</span>,
              <span class='kw'>constr</span><span class='kw'>=</span><span class='fu'>matrix</span>(<span class='fl'>0</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>12</span>), <span class='kw'>rhs</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>nec</span><span class='kw'>=</span><span class='fl'>0</span>)
<span class='no'>fmunc</span></div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; orlm.formula(formula = cbind(SDH, SGOT, SGPT) ~ dose - 1, data = vinylidene, 
#&gt;     constr = matrix(0, nrow = 1, ncol = 12), rhs = 0, nec = 0)
#&gt; 
#&gt; Coefficients:
#&gt;         SDH    SGOT   SGPT 
#&gt; dosed1   22.7   99.3   61.9
#&gt; dosed2   22.8  108.4   63.8
#&gt; dosed3   23.7  100.9   60.2
#&gt; dosed4   27.3  112.9   52.9
#&gt; </div><div class='input'>
<span class='co'># calculate GORIC</span>
<span class='co'># (only small number of iterations to decrease computation time, default: iter=100000)</span>
<span class='fu'>goric</span>(<span class='no'>fm0</span>, <span class='no'>fm1</span>, <span class='no'>fmunc</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='fl'>1000</span>)</div><div class='output co'>#&gt;          loglik penalty    goric goric_weights
#&gt; fm0   -406.5447   4.000 821.0895         0.000
#&gt; fm1   -396.8473   7.514 808.7225         0.072
#&gt; fmunc -388.8036  13.000 803.6072         0.928</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Daniel Gerhard, Rebecca M. Kuiper.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
