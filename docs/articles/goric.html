<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to the goric package • goric</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">goric</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/goric.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Introduction to the goric package</h1>
            
          </div>

    
    
<div class="contents">
<div id="selecting-multivariate-linear-models-with-shape-constraints" class="section level2">
<h2 class="hasAnchor">
<a href="#selecting-multivariate-linear-models-with-shape-constraints" class="anchor"></a>Selecting multivariate linear models with shape constraints</h2>
<p>An experiment was conducted to find out whether vinylidene fluoride gives rise to liver damage. The dataset is available on page 10 of Silvapulle and Sen (2005) and in a report prepared by Litton Bionetics Inc in 1984. Since increased levels of serum enzyme are inherent in liver damage, the focus is on whether enzyme levels are affected by vinylidene fluoride. The variable of interest is the serum enzyme level. Three types of enzymes are inspected, namely SDH, SGOT, and SGPT. To study whether vinylidene fluoride has an influence on the three serum enzymes, four dosages of this substance are examined. In each of these four treatment groups, ten male Fischer-344 rats received the substance.</p>
<p>The data is available in the goric package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(goric)
<span class="kw">data</span>(vinylidene)
knitr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="kw">head</span>(vinylidene))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">SDH</th>
<th align="right">SGOT</th>
<th align="right">SGPT</th>
<th align="left">dose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">18</td>
<td align="right">101</td>
<td align="right">65</td>
<td align="left">d1</td>
</tr>
<tr class="even">
<td align="right">27</td>
<td align="right">103</td>
<td align="right">67</td>
<td align="left">d1</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">90</td>
<td align="right">52</td>
<td align="left">d1</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">98</td>
<td align="right">58</td>
<td align="left">d1</td>
</tr>
<tr class="odd">
<td align="right">26</td>
<td align="right">101</td>
<td align="right">64</td>
<td align="left">d1</td>
</tr>
<tr class="even">
<td align="right">22</td>
<td align="right">92</td>
<td align="right">60</td>
<td align="left">d1</td>
</tr>
</tbody>
</table>
</div>
<div id="estimating-marginal-dose-means" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-marginal-dose-means" class="anchor"></a>Estimating marginal dose means</h2>
<p>The dose is a factor with 4 levels; hence, we can estimate the average response per dose level in a linear model, setting the intercept to 0.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">cbind</span>(SDH, SGOT, SGPT) <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>dose, <span class="dt">data=</span>vinylidene)
knitr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="kw">coefficients</span>(m))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">SDH</th>
<th align="right">SGOT</th>
<th align="right">SGPT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>dosed1</td>
<td align="right">22.7</td>
<td align="right">99.3</td>
<td align="right">61.9</td>
</tr>
<tr class="even">
<td>dosed2</td>
<td align="right">22.8</td>
<td align="right">108.4</td>
<td align="right">63.8</td>
</tr>
<tr class="odd">
<td>dosed3</td>
<td align="right">23.7</td>
<td align="right">100.9</td>
<td align="right">60.2</td>
</tr>
<tr class="even">
<td>dosed4</td>
<td align="right">27.3</td>
<td align="right">112.9</td>
<td align="right">52.9</td>
</tr>
</tbody>
</table>
<p>Instead of the function lm(), we can use the function orlm() of the package goric. As we don’t want to add constraints on the parameters, we set all elements in the constraint matrix to 0.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">unconstrained &lt;-<span class="st"> </span><span class="kw"><a href="../reference/orlm.html">orlm</a></span>(<span class="kw">cbind</span>(SDH, SGOT, SGPT) <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>dose, 
                      <span class="dt">data=</span>vinylidene,
                      <span class="dt">constr=</span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span><span class="dv">1</span>, <span class="dt">ncol=</span><span class="dv">12</span>), 
                      <span class="dt">rhs=</span><span class="dv">0</span>, <span class="dt">nec=</span><span class="dv">0</span>)
knitr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="kw">coefficients</span>(unconstrained))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">SDH</th>
<th align="right">SGOT</th>
<th align="right">SGPT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>dosed1</td>
<td align="right">22.7</td>
<td align="right">99.3</td>
<td align="right">61.9</td>
</tr>
<tr class="even">
<td>dosed2</td>
<td align="right">22.8</td>
<td align="right">108.4</td>
<td align="right">63.8</td>
</tr>
<tr class="odd">
<td>dosed3</td>
<td align="right">23.7</td>
<td align="right">100.9</td>
<td align="right">60.2</td>
</tr>
<tr class="even">
<td>dosed4</td>
<td align="right">27.3</td>
<td align="right">112.9</td>
<td align="right">52.9</td>
</tr>
</tbody>
</table>
</div>
<div id="monotone-order-of-serum-levels" class="section level2">
<h2 class="hasAnchor">
<a href="#monotone-order-of-serum-levels" class="anchor"></a>Monotone order of serum levels</h2>
<p>We can fit a second model, adding the order constraints on the model coefficients of monotone increasing serum means with increasing dose levels. The constraints are included with a constraint matrix that defines linear combinations of model coefficients; therefore, this matrix needs to have the same number of columns as there are coefficients in the model; the first four columns correspond to the first response, the following columns represent the second and third response.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cmat &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="op">-</span><span class="kw">diag</span>(<span class="dv">3</span>), <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">cbind</span>(<span class="dv">0</span>, <span class="kw">diag</span>(<span class="dv">3</span>))
constr &lt;-<span class="st"> </span><span class="kw">kronecker</span>(<span class="kw">diag</span>(<span class="dv">3</span>), cmat)
knitr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(constr)</code></pre></div>
<table class="table"><tbody>
<tr class="odd">
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-1</td>
<td align="right">1</td>
</tr>
</tbody></table>
<p>The monotone increase is specified by constraining the difference between consecutive coefficients to be larger or equal than 0; hence, two additional arguments are needed: rhs defines the boundary of the inequality constraint space and nec denotes the number of inequality constraints, which can be either a number of rows or a logical vector, where TRUE defines an inequality constraint and FALSE an equality constraint.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">monotone &lt;-<span class="st"> </span><span class="kw"><a href="../reference/orlm.html">orlm</a></span>(<span class="kw">cbind</span>(SDH, SGOT, SGPT) <span class="op">~</span><span class="st"> </span>dose<span class="op">-</span><span class="dv">1</span>,
                 <span class="dt">data=</span>vinylidene,
                 <span class="dt">constr=</span>constr, 
                 <span class="dt">rhs=</span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">nrow</span>(constr)), 
                 <span class="dt">nec=</span><span class="dv">0</span>)
knitr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="kw">round</span>(<span class="kw">coefficients</span>(monotone), <span class="dv">2</span>))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">SDH</th>
<th align="right">SGOT</th>
<th align="right">SGPT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>dosed1</td>
<td align="right">22.71</td>
<td align="right">97.26</td>
<td align="right">59.7</td>
</tr>
<tr class="even">
<td>dosed2</td>
<td align="right">22.82</td>
<td align="right">102.52</td>
<td align="right">59.7</td>
</tr>
<tr class="odd">
<td>dosed3</td>
<td align="right">23.69</td>
<td align="right">102.52</td>
<td align="right">59.7</td>
</tr>
<tr class="even">
<td>dosed4</td>
<td align="right">27.28</td>
<td align="right">119.20</td>
<td align="right">59.7</td>
</tr>
</tbody>
</table>
<p>The comparison of the constrained with the unconstrained estimates demonstrate that there is one active constraint for SGOT, affecting the average serum estimates at dose levels 2 and 3, and for SGPT, enforcing a monotone order leads to the same estimate for all dose levels.</p>
</div>
<div id="equality-constraints" class="section level2">
<h2 class="hasAnchor">
<a href="#equality-constraints" class="anchor"></a>Equality constraints</h2>
<p>We can fit a third model under the assumption of no effect of the dose, changing all previous inequality constraints of the monotone order assumption into equality constraints.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">noeffect &lt;-<span class="st"> </span><span class="kw"><a href="../reference/orlm.html">orlm</a></span>(<span class="kw">cbind</span>(SDH, SGOT, SGPT) <span class="op">~</span><span class="st"> </span>dose<span class="op">-</span><span class="dv">1</span>,
                 <span class="dt">data=</span>vinylidene,
                 <span class="dt">constr=</span>constr, 
                 <span class="dt">rhs=</span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">nrow</span>(constr)), 
                 <span class="dt">nec=</span><span class="kw">nrow</span>(constr))
knitr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="kw">round</span>(<span class="kw">coefficients</span>(noeffect), <span class="dv">2</span>))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">SDH</th>
<th align="right">SGOT</th>
<th align="right">SGPT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>dosed1</td>
<td align="right">24.12</td>
<td align="right">105.38</td>
<td align="right">59.7</td>
</tr>
<tr class="even">
<td>dosed2</td>
<td align="right">24.12</td>
<td align="right">105.38</td>
<td align="right">59.7</td>
</tr>
<tr class="odd">
<td>dosed3</td>
<td align="right">24.12</td>
<td align="right">105.38</td>
<td align="right">59.7</td>
</tr>
<tr class="even">
<td>dosed4</td>
<td align="right">24.12</td>
<td align="right">105.37</td>
<td align="right">59.7</td>
</tr>
</tbody>
</table>
</div>
<div id="the-generalised-order-restricted-information-criterion" class="section level2">
<h2 class="hasAnchor">
<a href="#the-generalised-order-restricted-information-criterion" class="anchor"></a>The Generalised Order Restricted Information Criterion</h2>
<p>The three different models can be compared by calculating information criteria with the function goric(), which also provides model weights for each model in the set. The penalty term of the information criterion includes a level probability, which is computed by Monte-Carlo simulation; therefore, the number of Monte-Carlo iterations has to be provided.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ic &lt;-<span class="st"> </span><span class="kw"><a href="../reference/goric.html">goric</a></span>(unconstrained, monotone, noeffect, <span class="dt">iter=</span><span class="dv">100000</span>)
knitr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(ic)</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">loglik</th>
<th align="right">penalty</th>
<th align="right">goric</th>
<th align="right">goric_weights</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>unconstrained</td>
<td align="right">-388.8036</td>
<td align="right">13.00000</td>
<td align="right">803.6072</td>
<td align="right">0.994</td>
</tr>
<tr class="even">
<td>monotone</td>
<td align="right">-399.5223</td>
<td align="right">7.48294</td>
<td align="right">814.0106</td>
<td align="right">0.005</td>
</tr>
<tr class="odd">
<td>noeffect</td>
<td align="right">-406.5447</td>
<td align="right">4.00000</td>
<td align="right">821.0895</td>
<td align="right">0.000</td>
</tr>
</tbody>
</table>
<p>We obtain a very high weight for the unconstrained model, demonstrating that we cannot assume a monotone order of expected serum enzyme levels with increasing dosage for all of the three serums.</p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<ul>
<li><p>Kuiper R.M., Hoijtink H., Silvapulle M.J. (2011). An Akaike-type Information Criterion for Model Selection Under Inequality Constraints. <em>Biometrika</em>, <strong>98</strong>, 495-501.</p></li>
<li><p>Kuiper R.M., Hoijtink H., Silvapulle M.J. (2012). Generalization of the Order-Restricted Information Criterion for Multivariate Normal Linear Models. <em>Journal of Statistical Planning and Inference</em>, <strong>142</strong>, 2454-2463. <a href="doi:10.1016/j.jspi.2012.03.007" class="uri">doi:10.1016/j.jspi.2012.03.007</a>.</p></li>
<li><p>Kuiper R.M., Gerhard D., Hothorn L.A. (2014). Identification of the Minimum Effective Dose for Normally Distributed Endpoints Using a Model Selection Approach. <em>Statistics in Biopharmaceutical Research</em>, <strong>6</strong>(1), 55-66. <a href="doi:10.1080/19466315.2013.847384" class="uri">doi:10.1080/19466315.2013.847384</a></p></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#selecting-multivariate-linear-models-with-shape-constraints">Selecting multivariate linear models with shape constraints</a></li>
      <li><a href="#estimating-marginal-dose-means">Estimating marginal dose means</a></li>
      <li><a href="#monotone-order-of-serum-levels">Monotone order of serum levels</a></li>
      <li><a href="#equality-constraints">Equality constraints</a></li>
      <li><a href="#the-generalised-order-restricted-information-criterion">The Generalised Order Restricted Information Criterion</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Daniel Gerhard, Rebecca M. Kuiper.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
